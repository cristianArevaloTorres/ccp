@{
    Layout = "~/Views/Shared/_Main.cshtml";
}


@*@{
        var idioma = System.Threading.Thread.CurrentThread.CurrentUICulture.Name.ToLowerInvariant();
    }

    @helper selected(string c, string idioma)
    {
    if (c == idioma)
    {
            @:checked="checked"z
        }
    }*@


<div class="content">

    <div class="video-wrap">
        <video id="video" playsinline autoplay></video>
    </div>

    <!-- Trigger canvas web API -->
    <div class="controller">
        <button id="snap">Capture</button>
    </div>

    <canvas id="SigCnv2" width="640" height="480"></canvas>

    <script>
        'use strict';

        const video = document.getElementById('video');
        const canvas = document.getElementById('SigCnv2');
        const snap = document.getElementById("snap");
        const errorMsgElement = document.querySelector('span#errorMsg');

        const constraints = {
            audio: false,
            video: {
                width: 1280, height: 720
            }
        };

        // Access webcam
        async function init() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia(constraints);
                handleSuccess(stream);
            } catch (e) {
                errorMsgElement.innerHTML = `navigator.getUserMedia error:${e.toString()}`;
            }
        }

        // Success
        function handleSuccess(stream) {
            window.stream = stream;
            video.srcObject = stream;
        }

        // Load init
        init();

        // Draw image
        var context = canvas.getContext('2d');
        snap.addEventListener("click", function () {
            context.drawImage(video, 0, 0, 640, 480);
        });
    </script>

    <form id="form1" runat="server">
        <div>

            <canvas id="SigCnv" width="640" height="480"></canvas>




            <input type="button" id="btnSave" onclick="guardar()" name="btnSave" value="Save the canvas to server" />
            <script type="text/javascript">

                // Send the canvas image to the server.
                function guardar() {
                    var image = document.getElementById("SigCnv2").toDataURL("image/png");
                    image = image.replace('data:image/png;base64,', '');
                    $.ajax({
                        type: 'POST',
                        url: '/Login/UploadImage',
                        data: '{ "imageData" : "' + image + '" }',
                        contentType: 'application/json; charset=utf-8',
                        dataType: 'json',
                        success: function (msg) {
                            alert('Image saved successfully !');
                        }
                    });
                }



            </script>
        </div>
    </form>



    @using (Html.BeginForm("guardar", "Login", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {

        <input type="file" name="file" /> <button type="submit">Subir archivo</button>
    }


    <form class="login-form" method="post">
        <img style="width:150px; height:100px; align-content:center" src="~/Images/Polanco/presea.png" />
        <br />

        <h2 class="form-title">Sistema de almacen</h2>
        <h3 class="form-title">Acceder</h3>


        <div class="alert alert-danger display-hide" style="@TempData["estilo"]">
            <button class="close" data-close="alert"></button>
            @if (TempData["estilo"] != null)
            {
                <span>@TempData["error"]</span>
            }
            else
            {
                <span>Favor de ingresar su Usuario y Contraseña.</span>
            }
        </div>
        <div class="form-group">

            <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->
            <label class="control-label visible-ie8 visible-ie9">Usuario</label>
            <div class="input-icon">
                <i class="fa fa-user"></i>
                <input class="form-control placeholder-no-fix" type="text" autocomplete="off" placeholder="Usuario" id="username" name="username" />
            </div>
        </div>
        <div class="form-group">
            <label class="control-label visible-ie8 visible-ie9">Contraseña</label>
            <div class="input-icon">
                <i class="fa fa-lock"></i>
                <input class="form-control placeholder-no-fix" type="password" autocomplete="off" id="pp" placeholder="Contraseña" name="password" />
            </div>
        </div>

        <div class="form-actions">
            <div class="col-lg-6">
                <button id="btningresa" onclick="validarUsuario()" type="button" class="btn purple">
                    Ingresar
                </button>

            </div>

        </div>



    </form>
    <script>
        function ingresar() {
             var url = '@Url.Action("Index", "Bienvenido")';
            window.location.href = url;

        }
        function validarUsuario() {
            var user = $("#username").val();
                 var pp = $("#pp").val();
                   $.ajax({
            type: 'GET',
            url: "@Url.Action("ValidarUser", "Login")",
                       data: { contraseña: pp, usuario: user },
            success: function (response) {
                if (response == "1") {
                    //correcto
                    ingresar();
                }
                else {
                    alert("informacion incorrecta intentelo de nuevo....");
                }

            },
            error: function (result) {
                alert("" + result);
            }
        });
        }
    </script>
    <!-- END LOGIN FORM  fonfdo-->
    @*<div class="kt-grid__item kt-grid__item--order-tablet-and-mobile-2 kt-grid kt-grid--hor kt-login__aside" style="background-image: url(/metronic/themes/metronic/theme/default/demo8/dist/assets/media/bg/bg-4.jpg);">
            <div class="kt-grid__item">
                <a href="#" class="kt-login__logo">
                    <img src="/metronic/themes/metronic/theme/default/demo8/dist/assets/media/logos/logo-4.png">
                </a>
            </div>
            <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--ver">
                <div class="kt-grid__item kt-grid__item--middle">
                    <h3 class="kt-login__title">Welcome to Metronic!</h3>
                    <h4 class="kt-login__subtitle">The ultimate Bootstrap &amp; Angular 6 admin theme framework for next generation web apps.</h4>
                </div>
            </div>
            <div class="kt-grid__item">
                <div class="kt-login__info">
                    <div class="kt-login__copyright">
                        © 2018 Metronic
                    </div>
                    <div class="kt-login__menu">
                        <a href="#" class="kt-link">Privacy</a>
                        <a href="#" class="kt-link">Legal</a>
                        <a href="#" class="kt-link">Contact</a>
                    </div>
                </div>
            </div>
        </div>*@
</div>


